<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>InfoBridge - Planning Vols</title>

<style>
*{
 margin:0;
 padding:0;
 box-sizing:border-box;
 font-family:Arial, Helvetica, sans-serif;
}

body{
 background:linear-gradient(#eef2ff,#f8fafc);
 display:flex;
 min-height:100vh;
}

/* Sidebar */
.sidebar{
 width:250px;
 background:white;
 padding:25px 20px;
 box-shadow:2px 0 20px rgba(0,0,0,0.05);
}

.logo{
 margin-bottom:35px;
}

.logo img{
 max-width:100%;
 height:auto;
 display:block;
}


/* Menu */
.menu-item{
 display:block;
 padding:12px 15px;
 border-radius:10px;
 margin-bottom:8px;
 color:#475569;
 text-decoration:none;
 transition:.2s;
}

.menu-item:hover{
 background:#eef2ff;
 color:#2563eb;
}

.menu-item.active{
 background:#e0e7ff;
 color:#1e40af;
 font-weight:bold;
}

/* Main */
.main{
 flex:1;
 padding:30px 40px;
}

.header{
 display:flex;
 justify-content:space-between;
 margin-bottom:30px;
}

.search{
 background:white;
 padding:12px 20px;
 border-radius:40px;
 width:400px;
 border:none;
 box-shadow:0 5px 15px rgba(0,0,0,0.05);
}

.user{
 background:white;
 padding:10px 18px;
 border-radius:30px;
 box-shadow:0 5px 15px rgba(0,0,0,0.05);
}

/* Cards */
.cards{
 display:grid;
 grid-template-columns:repeat(3,1fr);
 gap:20px;
 margin-bottom:30px;
}

.card{
 padding:20px;
 border-radius:18px;
 color:white;
 box-shadow:0 10px 25px rgba(0,0,0,0.08);
}

.card span{
 font-size:30px;
 font-weight:bold;
 display:block;
 margin-top:5px;
}

.blue{background:linear-gradient(45deg,#3b82f6,#60a5fa);}
.orange{background:linear-gradient(45deg,#f59e0b,#fbbf24);}

/* Table */
.table-box{
 background:white;
 padding:25px;
 border-radius:20px;
 margin-bottom:25px;
 box-shadow:0 10px 30px rgba(0,0,0,0.05);
}

.table{
 width:100%;
 border-collapse:collapse;
}

.table th,.table td{
 padding:12px;
 border-top:1px solid #f1f5f9;
 text-align:left;
}

.badge{
 padding:6px 12px;
 border-radius:20px;
 font-size:12px;
 font-weight:bold;
}

.badge.green{background:#dcfce7;color:#15803d;}
.badge.orange{background:#fef3c7;color:#b45309;}
.badge.blue{background:#dbeafe;color:#1e40af;}
.excel-import{
 margin:15px 0 25px 0;
 padding:20px;
 border:2px dashed #2563eb;
 border-radius:14px;
 text-align:center;
 background:#f8fafc;
}

.excel-import p{
 margin-bottom:10px;
 font-weight:bold;
 color:#1e40af;
}
.btnAddPlanning{
 margin-top:15px;
 background:#2563eb;
 color:white;
 border:none;
 padding:10px 22px;
 border-radius:10px;
 font-weight:bold;
 cursor:pointer;
 transition:.2s;
}

.btnAddPlanning:hover{
 background:#1e40af;
}

</style>
</head>

<body>

<!-- Sidebar -->
<div class="sidebar">

<div class="logo">
<img src="logoInfoBridge.png" alt="InfoBridge Logo">
</div>

<a class="menu-item" href="index.html">Tableau de bord</a>
<a class="menu-item active" href="infobridge_dashboard.html">Planning vols</a>
<a class="menu-item" href="bons_livraison.html">Bons de livraison</a>
<a class="menu-item" href="reception.html">Réceptions</a>
<a class="menu-item" href="bon_reception_wms.html">Bon Réception WMS</a>
<a class="menu-item" href="client.html">client</a>
<a class="menu-item" href="historique.html">Historique</a>

</div>

<!-- Main -->
<div class="main">

<div class="header">
<input class="search" placeholder="Rechercher...">
<div class="user">Mohammad</div>
</div>

<h2 style="margin-bottom:20px">
Bonjour Mohammad, voici le planning des vols entrants
</h2>

<div class="cards">
<div class="card blue">Alertes réception <span>5</span></div>
<div class="card blue">Vols arrivant <span>8</span></div>
<div class="card orange">Bons livraison <span>11</span></div>
</div>

<div class="excel-import">

    <p>Importer planning des vols (Excel)</p>
    <input type="file" id="excelFile" accept=".xlsx, .xls">

    <button class="btnAddPlanning" onclick="addPlanning()">
        Ajouter planning des vols
    </button>

</div>
<div class="table-box">
<h3>Planning des vols entrants</h3>


<table class="table">
<tr>
<th>Heure</th>
<th>Provenance</th>
<th>Vol</th>
<th>Infos</th>
</tr>


</table>
</div>

</div>
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script>
window.onload = function(){
    fillTable([]);   // ✅ Tableau vide au démarrage
};
let excelData = [];

document.getElementById("excelFile").addEventListener("change", function(e){

    const file = e.target.files[0];
    if(!file) return;

    const reader = new FileReader();

    reader.onload = function(event){

        const data = new Uint8Array(event.target.result);
        const workbook = XLSX.read(data, {type:"array"});

        const sheet = workbook.Sheets[workbook.SheetNames[0]];

        excelData = XLSX.utils.sheet_to_json(sheet);

        alert("Fichier chargé ✅ Clique sur Ajouter planning");
    };

    reader.readAsArrayBuffer(file);
});


function addPlanning(){

    if(excelData.length === 0){
        alert("Veuillez importer un fichier Excel");
        return;
    }

    fillTable(excelData);
}


function fillTable(rows){

    const table = document.querySelector(".table");

    if(rows.length === 0){
        table.innerHTML = `
            <tr>
                <th>Heure</th>
                <th>Provenance</th>
                <th>Vol</th>
                <th>Infos</th>
            </tr>
            <tr>
                <td colspan="4" style="text-align:center;color:#94a3b8;padding:30px;">
                    Aucun vol importé
                </td>
            </tr>
        `;
        return;
    }

    table.innerHTML = `
        <tr>
            <th>Heure</th>
            <th>Provenance</th>
            <th>Vol</th>
            <th>Infos</th>
        </tr>
    `;

    rows.forEach(row => {

        table.innerHTML += `
            <tr>
                <td>${row.Heure || "-"}</td>
                <td>${row.Provenance || "-"}</td>
                <td>${row.Vol || "-"}</td>
                <td><span class="badge blue">ETA ${row.Heure || "-"}</span></td>
            </tr>
        `;
    });

}


</script>


</body>
</html>
